<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ููุญุฉ ุงูุชุญูู - ClassWithOnline</title>
    <link rel="stylesheet" href="../assets/css/style.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js"></script>
</head>
<body>
    <!-- ุฑุฃุณ ุงููููุน -->
    <header>
        <div class="header-container">
            <a href="../index.html" class="logo">๐ ClassWithOnline - ููุญุฉ ุงูุชุญูู</a>
            <nav>
                <ul>
                    <li><a href="../index.html">ุงูุนูุฏุฉ ูููููุน</a></li>
                    <li><a href="#" onclick="logout()">ุชุณุฌูู ุงูุฎุฑูุฌ</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- ุงููุญุชูู ุงูุฑุฆูุณู -->
    <div class="container">
        <!-- ุงูุดุฑูุท ุงูุฌุงูุจู -->
        <aside class="sidebar">
            <h3>ุฅุฏุงุฑุฉ ุงููุญุชูู</h3>
            <ul>
                <li><a href="#courses" class="active">ุงูุฏูุฑุงุช</a></li>
                <li><a href="#quizzes">ุงูุงุฎุชุจุงุฑุงุช</a></li>
                <li><a href="#messages">ุงูุฑุณุงุฆู</a></li>
                <li><a href="#notifications">ุงูุชูุจููุงุช</a></li>
                <li><a href="#analytics">ุงูุฅุญุตุงุฆูุงุช</a></li>
            </ul>
        </aside>

        <!-- ุงููุญุชูู -->
        <main class="content">
            <!-- ูุณู ุงูุฏูุฑุงุช -->
            <section id="courses">
                <h1>๐ ุฅุฏุงุฑุฉ ุงูุฏูุฑุงุช</h1>

                <h2>ุฅุถุงูุฉ ุฏูุฑุฉ ุฌุฏูุฏุฉ</h2>
                <form id="course-form" onsubmit="addCourse(event)">
                    <div class="form-group">
                        <label for="course-title">ุนููุงู ุงูุฏูุฑุฉ</label>
                        <input type="text" id="course-title" placeholder="ุฃุฏุฎู ุนููุงู ุงูุฏูุฑุฉ" required>
                    </div>

                    <div class="form-group">
                        <label for="course-description">ูุตู ุงูุฏูุฑุฉ</label>
                        <textarea id="course-description" placeholder="ุฃุฏุฎู ูุตู ุงูุฏูุฑุฉ" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="course-level">ุงููุณุชูู</label>
                        <select id="course-level" required>
                            <option value="">ุงุฎุชุฑ ุงููุณุชูู</option>
                            <option value="Beginner">ูุจุชุฏุฆ</option>
                            <option value="Intermediate">ูุชูุณุท</option>
                            <option value="Advanced">ูุชูุฏู</option>
                        </select>
                    </div>

                    <button type="submit" class="btn btn-success btn-block">ุฅุถุงูุฉ ุงูุฏูุฑุฉ</button>
                </form>

                <h2 style="margin-top: 2rem;">ุงูุฏูุฑุงุช ุงูููุฌูุฏุฉ</h2>
                <div id="courses-list" class="cards-grid">
                    <p>ุฌุงุฑู ุงูุชุญููู...</p>
                </div>
            </section>

            <!-- ูุณู ุงูุงุฎุชุจุงุฑุงุช -->
            <section id="quizzes" style="margin-top: 3rem;">
                <h1>โ๏ธ ุฅุฏุงุฑุฉ ุงูุงุฎุชุจุงุฑุงุช</h1>

                <h2>ุฅุถุงูุฉ ุงุฎุชุจุงุฑ ุฌุฏูุฏ</h2>
                <form id="quiz-form" onsubmit="addQuiz(event)">
                    <div class="form-group">
                        <label for="quiz-title">ุนููุงู ุงูุงุฎุชุจุงุฑ</label>
                        <input type="text" id="quiz-title" placeholder="ุฃุฏุฎู ุนููุงู ุงูุงุฎุชุจุงุฑ" required>
                    </div>

                    <div class="form-group">
                        <label for="quiz-description">ูุตู ุงูุงุฎุชุจุงุฑ</label>
                        <textarea id="quiz-description" placeholder="ุฃุฏุฎู ูุตู ุงูุงุฎุชุจุงุฑ"></textarea>
                    </div>

                    <div id="questions-container">
                        <h3>ุงูุฃุณุฆูุฉ</h3>
                        <div class="question-item" data-question="0">
                            <div class="form-group">
                                <label>ูุต ุงูุณุคุงู</label>
                                <input type="text" class="question-text" placeholder="ุฃุฏุฎู ูุต ุงูุณุคุงู" required>
                            </div>

                            <div class="form-group">
                                <label>ุงูุฎูุงุฑุงุช (ููุตููุฉ ุจูุงุตูุฉ)</label>
                                <input type="text" class="question-options" placeholder="ุงูุฎูุงุฑ 1, ุงูุฎูุงุฑ 2, ุงูุฎูุงุฑ 3" required>
                            </div>

                            <div class="form-group">
                                <label>ุฑูู ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ (1, 2, 3...)</label>
                                <input type="number" class="question-answer" min="1" placeholder="1" required>
                            </div>

                            <button type="button" class="btn btn-danger" onclick="removeQuestion(this)">ุญุฐู ุงูุณุคุงู</button>
                        </div>
                    </div>

                    <button type="button" class="btn btn-warning" onclick="addQuestion()">ุฅุถุงูุฉ ุณุคุงู</button>
                    <button type="submit" class="btn btn-success btn-block" style="margin-top: 1rem;">ุฅุถุงูุฉ ุงูุงุฎุชุจุงุฑ</button>
                </form>

                <h2 style="margin-top: 2rem;">ุงูุงุฎุชุจุงุฑุงุช ุงูููุฌูุฏุฉ</h2>
                <div id="quizzes-list" class="cards-grid">
                    <p>ุฌุงุฑู ุงูุชุญููู...</p>
                </div>
            </section>

            <!-- ูุณู ุงูุฑุณุงุฆู -->
            <section id="messages" style="margin-top: 3rem;">
                <h1>๐ฌ ุฅุฏุงุฑุฉ ุงูุฑุณุงุฆู</h1>

                <h2>ุงูุฑุณุงุฆู ุงูุฃุฎูุฑุฉ</h2>
                <div id="messages-list" class="messages-container">
                    <p style="padding: 1rem;">ุฌุงุฑู ุงูุชุญููู...</p>
                </div>
            </section>

            <!-- ูุณู ุงูุชูุจููุงุช -->
            <section id="notifications" style="margin-top: 3rem;">
                <h1>๐ ุฅุฏุงุฑุฉ ุงูุชูุจููุงุช</h1>

                <h2>ุฅุถุงูุฉ ุชูุจูู ุฌุฏูุฏ</h2>
                <form id="notification-form" onsubmit="addNotification(event)">
                    <div class="form-group">
                        <label for="notification-title">ุนููุงู ุงูุชูุจูู</label>
                        <input type="text" id="notification-title" placeholder="ุฃุฏุฎู ุนููุงู ุงูุชูุจูู" required>
                    </div>

                    <div class="form-group">
                        <label for="notification-message">ูุต ุงูุชูุจูู</label>
                        <textarea id="notification-message" placeholder="ุฃุฏุฎู ูุต ุงูุชูุจูู" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="notification-type">ููุน ุงูุชูุจูู</label>
                        <select id="notification-type" required>
                            <option value="info">ูุนูููุฉ</option>
                            <option value="success">ูุฌุงุญ</option>
                            <option value="warning">ุชุญุฐูุฑ</option>
                            <option value="danger">ุฎุทุฑ</option>
                        </select>
                    </div>

                    <button type="submit" class="btn btn-success btn-block">ุฅุถุงูุฉ ุงูุชูุจูู</button>
                </form>

                <h2 style="margin-top: 2rem;">ุงูุชูุจููุงุช ุงูููุฌูุฏุฉ</h2>
                <div id="notifications-list">
                    <p>ุฌุงุฑู ุงูุชุญููู...</p>
                </div>
            </section>

            <!-- ูุณู ุงูุฅุญุตุงุฆูุงุช -->
            <section id="analytics" style="margin-top: 3rem;">
                <h1>๐ ุงูุฅุญุตุงุฆูุงุช</h1>

                <div class="cards-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>ุนุฏุฏ ุงูุฏูุฑุงุช</h3>
                        </div>
                        <div class="card-body">
                            <p style="font-size: 2rem; text-align: center; color: var(--secondary-color);">
                                <span id="courses-count">0</span>
                            </p>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3>ุนุฏุฏ ุงูุงุฎุชุจุงุฑุงุช</h3>
                        </div>
                        <div class="card-body">
                            <p style="font-size: 2rem; text-align: center; color: var(--secondary-color);">
                                <span id="quizzes-count">0</span>
                            </p>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3>ุนุฏุฏ ุงูุฑุณุงุฆู</h3>
                        </div>
                        <div class="card-body">
                            <p style="font-size: 2rem; text-align: center; color: var(--secondary-color);">
                                <span id="messages-count">0</span>
                            </p>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3>ุนุฏุฏ ุงูุชูุจููุงุช</h3>
                        </div>
                        <div class="card-body">
                            <p style="font-size: 2rem; text-align: center; color: var(--secondary-color);">
                                <span id="notifications-count">0</span>
                            </p>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- ุงูุชุฐููู -->
    <footer>
        <p>&copy; 2024 ููุตุฉ ClassWithOnline ููุชุนููู ุงูุฅููุชุฑููู - ููุญุฉ ุงูุชุญูู</p>
    </footer>

    <!-- ูููุงุช JavaScript -->
    <script src="../assets/js/firebase-app.js"></script>
    <script>
        /**
         * ุฏุงูุฉ ูุฅุถุงูุฉ ุฏูุฑุฉ
         */
        function addCourse(event) {
            event.preventDefault();

            const title = document.getElementById('course-title').value;
            const description = document.getElementById('course-description').value;
            const level = document.getElementById('course-level').value;

            const course = {
                title: title,
                description: description,
                level: level,
                videos: [],
                files: []
            };

            addToFirebase('courses', course).then(() => {
                document.getElementById('course-form').reset();
                loadCourses();
                updateStats();
            });
        }

        /**
         * ุฏุงูุฉ ูุชุญููู ุงูุฏูุฑุงุช
         */
        function loadCourses() {
            readFromFirebase('courses', (data) => {
                const container = document.getElementById('courses-list');
                if (!data) {
                    container.innerHTML = '<p>ูุง ุชูุฌุฏ ุฏูุฑุงุช</p>';
                    return;
                }

                container.innerHTML = '';
                Object.keys(data).forEach(key => {
                    const course = data[key];
                    const card = document.createElement('div');
                    card.className = 'card';
                    card.innerHTML = `
                        <div class="card-header">
                            <h3>${course.title}</h3>
                        </div>
                        <div class="card-body">
                            <p>${course.description}</p>
                            <p><strong>ุงููุณุชูู:</strong> ${course.level}</p>
                        </div>
                        <div class="card-footer">
                            <button class="btn btn-danger" onclick="deleteCourseItem('${key}')">ุญุฐู</button>
                        </div>
                    `;
                    container.appendChild(card);
                });
            });
        }

        /**
         * ุฏุงูุฉ ูุญุฐู ุฏูุฑุฉ
         */
        function deleteCourseItem(courseId) {
            if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐู ุงูุฏูุฑุฉุ')) {
                deleteFromFirebase(`courses/${courseId}`).then(() => {
                    loadCourses();
                    updateStats();
                });
            }
        }

        /**
         * ุฏุงูุฉ ูุฅุถุงูุฉ ุณุคุงู
         */
        function addQuestion() {
            const container = document.getElementById('questions-container');
            const questionCount = container.querySelectorAll('.question-item').length;

            const questionDiv = document.createElement('div');
            questionDiv.className = 'question-item';
            questionDiv.setAttribute('data-question', questionCount);
            questionDiv.innerHTML = `
                <div class="form-group">
                    <label>ูุต ุงูุณุคุงู</label>
                    <input type="text" class="question-text" placeholder="ุฃุฏุฎู ูุต ุงูุณุคุงู" required>
                </div>

                <div class="form-group">
                    <label>ุงูุฎูุงุฑุงุช (ููุตููุฉ ุจูุงุตูุฉ)</label>
                    <input type="text" class="question-options" placeholder="ุงูุฎูุงุฑ 1, ุงูุฎูุงุฑ 2, ุงูุฎูุงุฑ 3" required>
                </div>

                <div class="form-group">
                    <label>ุฑูู ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ (1, 2, 3...)</label>
                    <input type="number" class="question-answer" min="1" placeholder="1" required>
                </div>

                <button type="button" class="btn btn-danger" onclick="removeQuestion(this)">ุญุฐู ุงูุณุคุงู</button>
            `;

            container.appendChild(questionDiv);
        }

        /**
         * ุฏุงูุฉ ูุญุฐู ุณุคุงู
         */
        function removeQuestion(button) {
            button.parentElement.remove();
        }

        /**
         * ุฏุงูุฉ ูุฅุถุงูุฉ ุงุฎุชุจุงุฑ
         */
        function addQuiz(event) {
            event.preventDefault();

            const title = document.getElementById('quiz-title').value;
            const description = document.getElementById('quiz-description').value;
            const questions = {};

            document.querySelectorAll('.question-item').forEach((item, index) => {
                const text = item.querySelector('.question-text').value;
                const optionsStr = item.querySelector('.question-options').value;
                const correctAnswerIndex = parseInt(item.querySelector('.question-answer').value) - 1;

                const options = {};
                optionsStr.split(',').forEach((opt, i) => {
                    options[i] = opt.trim();
                });

                questions[index] = {
                    text: text,
                    options: options,
                    correctAnswer: correctAnswerIndex
                };
            });

            const quiz = {
                title: title,
                description: description,
                questions: questions
            };

            addToFirebase('quizzes', quiz).then(() => {
                document.getElementById('quiz-form').reset();
                document.getElementById('questions-container').innerHTML = `
                    <h3>ุงูุฃุณุฆูุฉ</h3>
                    <div class="question-item" data-question="0">
                        <div class="form-group">
                            <label>ูุต ุงูุณุคุงู</label>
                            <input type="text" class="question-text" placeholder="ุฃุฏุฎู ูุต ุงูุณุคุงู" required>
                        </div>

                        <div class="form-group">
                            <label>ุงูุฎูุงุฑุงุช (ููุตููุฉ ุจูุงุตูุฉ)</label>
                            <input type="text" class="question-options" placeholder="ุงูุฎูุงุฑ 1, ุงูุฎูุงุฑ 2, ุงูุฎูุงุฑ 3" required>
                        </div>

                        <div class="form-group">
                            <label>ุฑูู ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ (1, 2, 3...)</label>
                            <input type="number" class="question-answer" min="1" placeholder="1" required>
                        </div>

                        <button type="button" class="btn btn-danger" onclick="removeQuestion(this)">ุญุฐู ุงูุณุคุงู</button>
                    </div>
                `;
                loadQuizzes();
                updateStats();
            });
        }

        /**
         * ุฏุงูุฉ ูุชุญููู ุงูุงุฎุชุจุงุฑุงุช
         */
        function loadQuizzes() {
            readFromFirebase('quizzes', (data) => {
                const container = document.getElementById('quizzes-list');
                if (!data) {
                    container.innerHTML = '<p>ูุง ุชูุฌุฏ ุงุฎุชุจุงุฑุงุช</p>';
                    return;
                }

                container.innerHTML = '';
                Object.keys(data).forEach(key => {
                    const quiz = data[key];
                    const card = document.createElement('div');
                    card.className = 'card';
                    card.innerHTML = `
                        <div class="card-header">
                            <h3>${quiz.title}</h3>
                        </div>
                        <div class="card-body">
                            <p>${quiz.description}</p>
                            <p><strong>ุนุฏุฏ ุงูุฃุณุฆูุฉ:</strong> ${Object.keys(quiz.questions || {}).length}</p>
                        </div>
                        <div class="card-footer">
                            <button class="btn btn-danger" onclick="deleteQuizItem('${key}')">ุญุฐู</button>
                        </div>
                    `;
                    container.appendChild(card);
                });
            });
        }

        /**
         * ุฏุงูุฉ ูุญุฐู ุงุฎุชุจุงุฑ
         */
        function deleteQuizItem(quizId) {
            if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐุง ุงูุงุฎุชุจุงุฑุ')) {
                deleteFromFirebase(`quizzes/${quizId}`).then(() => {
                    loadQuizzes();
                    updateStats();
                });
            }
        }

        /**
         * ุฏุงูุฉ ูุฅุถุงูุฉ ุชูุจูู
         */
        function addNotification(event) {
            event.preventDefault();

            const title = document.getElementById('notification-title').value;
            const message = document.getElementById('notification-message').value;
            const type = document.getElementById('notification-type').value;

            const notification = {
                title: title,
                message: message,
                type: type
            };

            addToFirebase('notifications', notification).then(() => {
                document.getElementById('notification-form').reset();
                loadNotifications();
                updateStats();
            });
        }

        /**
         * ุฏุงูุฉ ูุชุญููู ุงูุชูุจููุงุช
         */
        function loadNotifications() {
            readFromFirebase('notifications', (data) => {
                const container = document.getElementById('notifications-list');
                if (!data) {
                    container.innerHTML = '<p>ูุง ุชูุฌุฏ ุชูุจููุงุช</p>';
                    return;
                }

                container.innerHTML = '';
                Object.keys(data).reverse().forEach(key => {
                    const notification = data[key];
                    const alertDiv = document.createElement('div');
                    alertDiv.className = `alert alert-${notification.type || 'info'}`;
                    alertDiv.innerHTML = `
                        <strong>${notification.title}</strong><br>
                        ${notification.message}
                    `;
                    container.appendChild(alertDiv);
                });
            });
        }

        /**
         * ุฏุงูุฉ ูุชุญููู ุงูุฑุณุงุฆู
         */
        function loadMessagesAdmin() {
            readFromFirebase('messages', (data) => {
                const container = document.getElementById('messages-list');
                if (!data) {
                    container.innerHTML = '<p>ูุง ุชูุฌุฏ ุฑุณุงุฆู</p>';
                    return;
                }

                container.innerHTML = '';
                Object.keys(data).reverse().forEach(key => {
                    const message = data[key];
                    const messageDiv = document.createElement('div');
                    messageDiv.className = 'message';
                    messageDiv.innerHTML = `
                        <div class="message-header">
                            <span class="message-sender">${message.sender}</span>
                            <span class="message-time">${message.timestamp}</span>
                        </div>
                        <div class="message-body">${message.text}</div>
                    `;
                    container.appendChild(messageDiv);
                });
            });
        }

        /**
         * ุฏุงูุฉ ูุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช
         */
        function updateStats() {
            readFromFirebase('courses', (data) => {
                document.getElementById('courses-count').textContent = data ? Object.keys(data).length : 0;
            });

            readFromFirebase('quizzes', (data) => {
                document.getElementById('quizzes-count').textContent = data ? Object.keys(data).length : 0;
            });

            readFromFirebase('messages', (data) => {
                document.getElementById('messages-count').textContent = data ? Object.keys(data).length : 0;
            });

            readFromFirebase('notifications', (data) => {
                document.getElementById('notifications-count').textContent = data ? Object.keys(data).length : 0;
            });
        }

        /**
         * ุฏุงูุฉ ูุชุณุฌูู ุงูุฎุฑูุฌ
         */
        function logout() {
            if (confirm('ูู ุชุฑูุฏ ุชุณุฌูู ุงูุฎุฑูุฌุ')) {
                window.location.href = '../index.html';
            }
        }

        /**
         * ุชุญููู ุงูุจูุงูุงุช ุนูุฏ ุชุญููู ุงูุตูุญุฉ
         */
        document.addEventListener('DOMContentLoaded', () => {
            loadCourses();
            loadQuizzes();
            loadMessagesAdmin();
            loadNotifications();
            updateStats();

            // ุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช ูู 10 ุซูุงูู
            setInterval(updateStats, 10000);
        });

        /**
         * ุงูุชููู ุจูู ุงูุฃูุณุงู
         */
        document.querySelectorAll('.sidebar a').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const href = this.getAttribute('href');
                
                // ุฅุฒุงูุฉ ุงููุฆุฉ active ูู ุฌููุน ุงูุฑูุงุจุท
                document.querySelectorAll('.sidebar a').forEach(l => l.classList.remove('active'));
                this.classList.add('active');

                // ุฅุฎูุงุก ุฌููุน ุงูุฃูุณุงู
                document.querySelectorAll('main section').forEach(section => {
                    section.style.display = 'none';
                });

                // ุนุฑุถ ุงููุณู ุงููุฎุชุงุฑ
                const target = document.querySelector(href);
                if (target) {
                    target.style.display = 'block';
                    target.scrollIntoView({ behavior: 'smooth' });
                }
            });
        });

        // ุฅุธูุงุฑ ุงููุณู ุงูุฃูู ุงูุชุฑุงุถูุงู
        document.querySelectorAll('main section').forEach((section, index) => {
            section.style.display = index === 0 ? 'block' : 'none';
        });
    </script>
</body>
</html>
